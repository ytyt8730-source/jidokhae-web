# 서브에이전트 사용 가이드

> 비전공자도 쉽게 이해할 수 있는 Claude Code 서브에이전트 완전 정복

---

## 서브에이전트란?

**서브에이전트**는 특정 작업에 특화된 "전문가 AI"입니다.

일반 Claude에게 "코딩해줘"라고 하면 범용적으로 답변하지만,
`@agent-코딩`에게 요청하면 **이 프로젝트의 규칙을 완벽히 이해한 전문가**가 작업합니다.

### 비유로 이해하기

```
일반 Claude = 종합병원 접수처
서브에이전트 = 각 과의 전문의

"배가 아파요" → 접수처는 어디로 가야할지 안내
"배가 아파요" → 내과 전문의는 바로 진료 시작
```

### 왜 사용하나요?

| 일반 요청 | 서브에이전트 |
|----------|-------------|
| 매번 프로젝트 규칙 설명 필요 | 이미 규칙을 알고 있음 |
| 일관성 없는 결과 | 항상 같은 품질 |
| 토큰(비용) 많이 소모 | 효율적인 토큰 사용 |

---

## 핵심 개념 3가지

### 1. 토큰 (Token)

**토큰**은 AI가 읽고 쓰는 "글자 단위"입니다.

```
"안녕하세요" = 약 3-4 토큰
긴 코드 파일 = 수천 토큰
```

토큰을 많이 쓰면:
- 비용 증가
- 대화가 길어지면 앞부분을 잊어버림
- 속도 저하

**서브에이전트는 토큰을 아끼도록 설계되어 있습니다.**

### 2. 컨텍스트 (Context)

**컨텍스트**는 AI가 "기억하고 있는 정보"입니다.

```
대화 시작 시: 컨텍스트 = 0%
코드 많이 읽음: 컨텍스트 = 70%
너무 많이 읽음: 컨텍스트 = 100% (더 이상 기억 못함!)
```

**서브에이전트는 필요한 정보만 읽어서 컨텍스트를 절약합니다.**

### 3. 모델 (Model)

AI에도 "등급"이 있습니다:

| 모델 | 특징 | 용도 |
|------|------|------|
| **Haiku** | 빠르고 저렴 | 단순 작업 (검사, 현황 파악) |
| **Sonnet** | 균형 잡힌 성능 | 일반 작업 (대부분) |
| **Opus** | 최고 품질 | 복잡한 분석 |

서브에이전트마다 적합한 모델이 자동 배정됩니다.

---

## 서브에이전트 사용법

### 기본 호출 방법

```
@agent-[에이전트이름] [요청 내용]
```

예시:
```
@agent-코딩 Phase 1 구현해줘
@agent-학습 React hooks 설명해줘
@agent-Git 커밋해줘
```

---

## 에이전트별 상세 가이드

### 1. 컨텍스트 에이전트 (`@agent-컨텍스트`)

**역할**: 프로젝트 현재 상황 파악

**언제 사용하나요?**
- 새로운 대화를 시작할 때
- "지금 뭐 하고 있었지?" 싶을 때
- 오랜만에 프로젝트를 열었을 때

**사용 예시**:
```
@agent-컨텍스트 현황 파악해줘
@agent-컨텍스트 지금 어디까지 했어?
@agent-컨텍스트 M5 상태 알려줘
```

**작동 방식**:
1. `current-state.md` 파일 확인
2. 최근 Git 커밋 확인
3. 진행 중인 마일스톤 파악
4. 요약해서 알려줌

**알아두세요**: Haiku 모델 사용 (빠르고 저렴)

---

### 2. 아키텍트 에이전트 (`@agent-아키텍트`)

**역할**: 복잡한 작업의 실행 계획 수립

**언제 사용하나요?**
- 어디서부터 시작해야 할지 모를 때
- 큰 작업을 잘게 나눠야 할 때
- 어떤 에이전트를 써야 할지 모를 때

**사용 예시**:
```
@agent-아키텍트 M5 어떻게 진행하면 좋을까?
@agent-아키텍트 결제 기능 구현 계획 세워줘
@agent-아키텍트 이 에러 어떻게 접근해야 해?
```

**작동 방식**:
1. 요청 분석
2. 필요한 작업 목록 작성
3. 각 작업에 적합한 에이전트/스크립트 추천
4. 실행 순서 제안

**비유**: 건축 현장의 "현장 소장" - 직접 벽돌을 쌓지 않지만, 누가 뭘 해야 하는지 지시

---

### 3. 파이프라인 에이전트 (`@agent-파이프라인`)

**역할**: 마일스톤 전체를 자동으로 진행

**언제 사용하나요?**
- "이 마일스톤 끝까지 해줘" 할 때
- 여러 Phase를 연속으로 구현할 때
- 자동화된 개발이 필요할 때

**사용 예시**:
```
@agent-파이프라인 M5 진행해
@agent-파이프라인 M5 Phase 2부터 진행해
@agent-파이프라인 M5 이어서 진행해
```

**작동 방식**:
```
1. 브랜치 생성
2. Phase 1 시작
   → 빈 파일 구조 생성
   → 코드 구현
   → 검사 (타입/빌드/린트)
   → 커밋
3. Phase 2 시작
   → (반복)
4. 모든 Phase 완료
5. PR 생성 안내
```

**주의사항**:
- 컨텍스트 85% 도달 시 자동 중단
- 3회 연속 실패 시 자동 롤백
- main 브랜치에서 직접 작업 안 함

**비유**: 공장의 "자동화 생산 라인" - 버튼 하나로 제품 완성까지

---

### 4. 설계 에이전트 (`@agent-설계`)

**역할**: 마일스톤을 실행 가능한 Work Package로 분해

**언제 사용하나요?**
- 새 마일스톤을 시작할 때
- WP 문서가 없을 때

**사용 예시**:
```
@agent-설계 M6 WP 만들어줘
@agent-설계 결제 기능 설계해줘
```

**작동 방식**:
1. 마일스톤 요구사항 분석
2. Phase별로 작업 분해
3. 각 Phase의 목표와 산출물 정의
4. `roadmap/work-packages/WP-M6.md` 생성

**산출물 예시**:
```markdown
# WP-M6: 알림 시스템

## Phase 1: 기본 알림 인프라
- 목표: 알림 발송 기본 구조
- 파일: src/lib/notification.ts
- 완료 조건: 테스트 알림 발송 성공

## Phase 2: 카카오 알림톡 연동
...
```

---

### 5. 시나리오 에이전트 (`@agent-시나리오`)

**역할**: Phase별 상세 테스트 시나리오 생성

**언제 사용하나요?**
- WP에 시나리오가 없을 때
- 복잡한 기능의 테스트 케이스가 필요할 때

**사용 예시**:
```
@agent-시나리오 M5 Phase 2 시나리오 만들어줘
@agent-시나리오 결제 취소 시나리오 작성해줘
```

**작동 방식**:
Given-When-Then 형식으로 시나리오 작성

```markdown
### SC-M5-2-1: 관리자 결제 확인

**Given** (전제 조건)
- 계좌이체 신청이 완료된 상태
- 관리자가 로그인된 상태

**When** (동작)
- 관리자가 "입금 확인" 버튼 클릭

**Then** (결과)
- 결제 상태가 "완료"로 변경
- 사용자에게 알림 발송
```

---

### 6. Git 에이전트 (`@agent-Git`)

**역할**: 브랜치 생성, 커밋, 푸시, 머지 관리

**언제 사용하나요?**
- 코딩 시작 전 브랜치 생성
- 작업 완료 후 커밋
- PR 머지할 때

**사용 예시**:
```
@agent-Git 브랜치 만들어줘
@agent-Git 커밋해줘
@agent-Git 푸시해줘
@agent-Git main에 머지해줘
```

**작동 방식**:
```
브랜치 생성:
  git checkout -b feature/m5-payment

커밋:
  1. 변경사항 확인 (git status)
  2. 스테이징 (git add)
  3. 커밋 메시지 작성 (규칙에 맞게)
  4. 커밋 실행

푸시:
  git push origin [브랜치명]
```

**커밋 메시지 규칙**:
```
[M5] feat: 결제 버튼 구현
[M5] fix: 로그인 오류 수정
[M5] refactor: 코드 정리
```

**주의사항**:
- main 브랜치에서 직접 커밋 안 함
- force push 절대 금지
- 머지는 사용자 확인 후에만

---

### 7. 코딩 에이전트 (`@agent-코딩`)

**역할**: 실제 코드 구현

**언제 사용하나요?**
- Phase를 구현할 때
- 새 기능을 추가할 때
- 컴포넌트를 만들 때

**사용 예시**:
```
@agent-코딩 Phase 1 구현해줘
@agent-코딩 결제 버튼 만들어줘
@agent-코딩 이 컴포넌트 리팩토링해줘
```

**작동 방식**:
1. 시나리오/WP 문서 확인
2. 관련 파일 분석
3. 코드 작성 (CLAUDE.md 규칙 준수)
4. 자동으로 파일 크기 검사 (200줄 초과 시 경고)

**지키는 규칙**:
```
✅ 파일당 200줄 이하
✅ console.log 사용 금지 (logger 사용)
✅ as any 타입 금지
✅ Tailwind CSS 사용
✅ 서버/클라이언트 컴포넌트 구분
```

**비유**: 실제로 코드를 작성하는 "개발자"

---

### 8. 테스트 에이전트 (`@agent-테스트`)

**역할**: 시나리오 기반으로 구현 검증

**언제 사용하나요?**
- 코딩 완료 후
- 기능이 제대로 동작하는지 확인할 때

**사용 예시**:
```
@agent-테스트 Phase 1 검증해줘
@agent-테스트 결제 기능 테스트해줘
```

**작동 방식**:
1. 해당 Phase의 시나리오 확인
2. Given 조건 설정
3. When 동작 수행
4. Then 결과 확인
5. 통과/실패 보고

**테스트 결과 예시**:
```
📋 Phase 1 테스트 결과
━━━━━━━━━━━━━━━━━━━━━━

✅ SC-1: 결제 버튼 표시 - 통과
✅ SC-2: 결제 금액 계산 - 통과
❌ SC-3: 결제 완료 처리 - 실패
   → 에러: 결제 상태 업데이트 안 됨

🔍 실패 원인 추정:
   - registration 테이블 업데이트 쿼리 누락
```

---

### 9. 검사 에이전트 (`@agent-검사`)

**역할**: 타입 체크, 빌드, 린트 실행

**언제 사용하나요?**
- 커밋 전 최종 검사
- 에러가 있는지 확인할 때

**사용 예시**:
```
@agent-검사 검사해줘
@agent-검사 빌드 돌려줘
```

**작동 방식**:
```bash
1. npx tsc --noEmit    # 타입 체크
2. npm run build       # 빌드
3. npm run lint        # 코드 스타일
```

**결과 예시**:
```
📋 검사 결과
━━━━━━━━━━━━

✅ 타입 체크: 통과
✅ 빌드: 성공
⚠️ 린트: 경고 2개
   - 사용하지 않는 변수 (line 45)
   - import 순서 (line 12)

👉 커밋 가능합니다.
```

**팁**: 스크립트 `./scripts/check-all.sh`를 직접 실행해도 같은 결과 (토큰 절약!)

---

### 10. 수리 에이전트 (`@agent-수리`)

**역할**: 에러 분석 및 해결

**언제 사용하나요?**
- 테스트/검사가 실패했을 때
- 알 수 없는 에러가 발생했을 때
- 버그를 고쳐야 할 때

**사용 예시**:
```
@agent-수리 이 에러 고쳐줘
@agent-수리 빌드 실패 원인 찾아줘
@agent-수리 타입 에러 해결해줘
```

**작동 방식**:
1. 에러 메시지 분석
2. 관련 코드 확인
3. 근본 원인 파악
4. 최소한의 수정으로 해결
5. 수정 후 재검증

**중요**: 수리 에이전트는 "최소 수정" 원칙을 따릅니다.
- 에러만 고치고 다른 건 안 건드림
- 불필요한 리팩토링 안 함

---

### 11. 기록 에이전트 (`@agent-기록`)

**역할**: 작업 완료 기록 및 문서화

**언제 사용하나요?**
- WP(Work Package) 전체 완료 후
- 마일스톤 완료 후

**사용 예시**:
```
@agent-기록 M5 완료 기록해줘
@agent-기록 현재 상태 업데이트해줘
```

**작동 방식**:
1. 완료된 작업 요약
2. `log/WP-M5-완료-로그.md` 생성
3. `log/current-state.md` 업데이트
4. 다음 작업 안내

**산출물 예시**:
```markdown
# WP-M5 완료 로그

## 완료일: 2026-01-22

## 구현된 기능
- 관리자 대시보드
- 계좌이체 결제

## 변경된 파일
- src/app/admin/page.tsx
- src/components/TransferPayment.tsx
...

## 다음 단계
- M6 알림 시스템 구현
```

---

### 12. 학습 에이전트 (`@agent-학습`)

**역할**: 개념 설명 및 TIL(Today I Learned) 작성

**언제 사용하나요?**
- 모르는 개념이 있을 때
- 코드가 이해가 안 될 때
- 배운 것을 정리하고 싶을 때

**사용 예시**:
```
@agent-학습 React Server Component가 뭐야?
@agent-학습 Supabase RLS 설명해줘
@agent-학습 이 코드 어떻게 동작해?
```

**작동 방식**:
1. 개념을 쉽게 설명
2. 예시 코드 제공
3. 실제 프로젝트에서 어떻게 쓰이는지 설명
4. (선택) TIL 문서로 저장

**특징**:
- 비전공자 눈높이에 맞춤
- 비유를 많이 사용
- 단계별로 설명

---

### 13. 초기세팅 에이전트 (`@agent-초기세팅`)

**역할**: 새 프로젝트 폴더 구조 생성

**언제 사용하나요?**
- 완전히 새로운 프로젝트를 시작할 때
- (현재 프로젝트에서는 거의 사용 안 함)

**사용 예시**:
```
@agent-초기세팅 새 프로젝트 만들어줘
```

**작동 방식**:
1. 폴더 구조 생성 (/core, /docs, /roadmap 등)
2. 기본 문서 생성 (CLAUDE.md, README.md 등)
3. 설정 파일 생성

---

## 추천 워크플로우

### 일반 개발 (매일)

```
1. @agent-컨텍스트 현황 파악해줘     ← 시작
2. @agent-코딩 Phase N 구현해줘     ← 코딩
3. @agent-테스트 검증해줘           ← 테스트
4. @agent-검사 검사해줘             ← 검사
5. @agent-Git 커밋해줘              ← 저장
```

### 마일스톤 자동 진행

```
@agent-파이프라인 M5 진행해         ← 이것만!
```

### 에러 발생 시

```
@agent-수리 이 에러 고쳐줘
```

### 모르는 게 있을 때

```
@agent-학습 [개념] 설명해줘
```

---

## 스크립트 vs 에이전트

| 작업 | 추천 | 이유 |
|-----|------|------|
| 검사 (타입/빌드/린트) | `./scripts/check-all.sh` | 토큰 0 |
| 현황 파악 | `@agent-컨텍스트` | 분석 포함 |
| 패턴 검색 | `./scripts/find-pattern.sh` | 토큰 0 |
| 코드 구현 | `@agent-코딩` | AI 필요 |
| 브랜치/커밋 | `@agent-Git` | 규칙 준수 |

**원칙**: 단순 작업은 스크립트, 판단 필요한 작업은 에이전트

---

## 자주 묻는 질문

### Q: 에이전트가 너무 많아요. 뭐부터 써야 해요?

**A**: 이 3개만 기억하세요:
1. `@agent-컨텍스트` - 시작할 때
2. `@agent-코딩` - 코드 작성할 때
3. `@agent-Git` - 저장할 때

### Q: 에이전트가 실수하면 어떡해요?

**A**:
- `@agent-수리`로 고치거나
- `./scripts/rollback.sh`로 되돌리기

### Q: 토큰이 부족하다고 나와요.

**A**:
- 새 대화 시작
- 스크립트 활용 (토큰 0)
- `@agent-컨텍스트`로 간단히 상황 공유

### Q: 어떤 에이전트를 써야 할지 모르겠어요.

**A**: `@agent-아키텍트`에게 물어보세요!
```
@agent-아키텍트 [하고 싶은 것] 어떻게 하면 돼?
```

---

## 버전 정보

- 작성일: 2026-01-22
- 서브에이전트: 13개
- 스크립트: 22개
- 시스템 버전: v2.5
